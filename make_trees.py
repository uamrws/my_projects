import random

a = [{'id': 1, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 2, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 3, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 4, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 5, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 6, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 7, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 8, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 9, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 10, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 11, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 12, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 13, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 14, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 16, 'parent_id': 212, 'top_parent_id': 212},
     {'id': 17, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 18, 'parent_id': 120, 'top_parent_id': 120},
     {'id': 20, 'parent_id': 2, 'top_parent_id': 117},
     {'id': 25, 'parent_id': 120, 'top_parent_id': 120},
     {'id': 40, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 43, 'parent_id': 213, 'top_parent_id': 213},
     {'id': 68, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 88, 'parent_id': 188, 'top_parent_id': 188},
     {'id': 106, 'parent_id': 205, 'top_parent_id': 205},
     {'id': 117, 'parent_id': 0, 'top_parent_id': 117},
     {'id': 120, 'parent_id': 0, 'top_parent_id': 120},
     {'id': 188, 'parent_id': 0, 'top_parent_id': 188},
     {'id': 205, 'parent_id': 0, 'top_parent_id': 205},
     {'id': 212, 'parent_id': 0, 'top_parent_id': 212},
     {'id': 213, 'parent_id': 0, 'top_parent_id': 213},
     {'id': 245, 'parent_id': 1, 'top_parent_id': 117},
     {'id': 248, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 249, 'parent_id': 1, 'top_parent_id': 117},
     {'id': 251, 'parent_id': 20, 'top_parent_id': 117},
     {'id': 252, 'parent_id': 245, 'top_parent_id': 117},
     {'id': 253, 'parent_id': 3, 'top_parent_id': 117},
     {'id': 254, 'parent_id': 3, 'top_parent_id': 117},
     {'id': 255, 'parent_id': 20, 'top_parent_id': 117},
     {'id': 380, 'parent_id': 0, 'top_parent_id': 380},
     {'id': 389, 'parent_id': 120, 'top_parent_id': 120},
     {'id': 393, 'parent_id': 0, 'top_parent_id': 393},
     {'id': 450, 'parent_id': 380, 'top_parent_id': 380},
     {'id': 462, 'parent_id': 0, 'top_parent_id': 462},
     {'id': 464, 'parent_id': 462, 'top_parent_id': 462},
     {'id': 485, 'parent_id': 0, 'top_parent_id': 485},
     {'id': 486, 'parent_id': 0, 'top_parent_id': 486},
     {'id': 487, 'parent_id': 0, 'top_parent_id': 487},
     {'id': 488, 'parent_id': 213, 'top_parent_id': 213},
     {'id': 489, 'parent_id': 0, 'top_parent_id': 489},
     {'id': 494, 'parent_id': 0, 'top_parent_id': 494},
     {'id': 498, 'parent_id': 0, 'top_parent_id': 498},
     {'id': 499, 'parent_id': 498, 'top_parent_id': 498},
     {'id': 500, 'parent_id': 0, 'top_parent_id': 500},
     {'id': 502, 'parent_id': 500, 'top_parent_id': 500},
     {'id': 508, 'parent_id': 0, 'top_parent_id': 508},
     {'id': 509, 'parent_id': 508, 'top_parent_id': 508},
     {'id': 510, 'parent_id': 0, 'top_parent_id': 510},
     {'id': 514, 'parent_id': 0, 'top_parent_id': 514},
     {'id': 515, 'parent_id': 0, 'top_parent_id': 515},
     {'id': 516, 'parent_id': 0, 'top_parent_id': 516},
     {'id': 517, 'parent_id': 515, 'top_parent_id': 515},
     {'id': 518, 'parent_id': 514, 'top_parent_id': 514},
     {'id': 519, 'parent_id': 518, 'top_parent_id': 514},
     {'id': 521, 'parent_id': 0, 'top_parent_id': 521},
     {'id': 522, 'parent_id': 521, 'top_parent_id': 521},
     {'id': 525, 'parent_id': 380, 'top_parent_id': 380},
     {'id': 529, 'parent_id': 0, 'top_parent_id': 529},
     {'id': 530, 'parent_id': 529, 'top_parent_id': 529},
     {'id': 539, 'parent_id': 0, 'top_parent_id': 539},
     {'id': 540, 'parent_id': 0, 'top_parent_id': 540},
     {'id': 541, 'parent_id': 0, 'top_parent_id': 541},
     {'id': 542, 'parent_id': 541, 'top_parent_id': 541},
     {'id': 544, 'parent_id': 542, 'top_parent_id': 541},
     {'id': 549, 'parent_id': 380, 'top_parent_id': 380},
     {'id': 551, 'parent_id': 0, 'top_parent_id': 551},
     {'id': 552, 'parent_id': 0, 'top_parent_id': 552},
     {'id': 555, 'parent_id': 0, 'top_parent_id': 555},
     {'id': 556, 'parent_id': 0, 'top_parent_id': 556},
     {'id': 557, 'parent_id': 556, 'top_parent_id': 556},
     {'id': 558, 'parent_id': 557, 'top_parent_id': 556},
     {'id': 561, 'parent_id': 486, 'top_parent_id': 486},
     {'id': 562, 'parent_id': 485, 'top_parent_id': 485},
     {'id': 564, 'parent_id': 0, 'top_parent_id': 564},
     {'id': 565, 'parent_id': 564, 'top_parent_id': 564},
     {'id': 567, 'parent_id': 552, 'top_parent_id': 552},
     {'id': 574, 'parent_id': 0, 'top_parent_id': 574},
     {'id': 587, 'parent_id': 0, 'top_parent_id': 587},
     {'id': 591, 'parent_id': 0, 'top_parent_id': 591},
     {'id': 600, 'parent_id': 0, 'top_parent_id': 600},
     {'id': 601, 'parent_id': 0, 'top_parent_id': 601},
     {'id': 606, 'parent_id': 601, 'top_parent_id': 601},
     {'id': 607, 'parent_id': 601, 'top_parent_id': 601},
     {'id': 608, 'parent_id': 606, 'top_parent_id': 601},
     {'id': 609, 'parent_id': 606, 'top_parent_id': 601},
     {'id': 612, 'parent_id': 0, 'top_parent_id': 612},
     {'id': 615, 'parent_id': 0, 'top_parent_id': 615},
     {'id': 618, 'parent_id': 117, 'top_parent_id': 117},
     {'id': 619, 'parent_id': 618, 'top_parent_id': 117},
     {'id': 624, 'parent_id': 120, 'top_parent_id': 120},
     {'id': 625, 'parent_id': 624, 'top_parent_id': 120},
     {'id': 642, 'parent_id': 0, 'top_parent_id': 642},
     {'id': 653, 'parent_id': 0, 'top_parent_id': 653},
     {'id': 657, 'parent_id': 653, 'top_parent_id': 653},
     {'id': 658, 'parent_id': 0, 'top_parent_id': 658},
     {'id': 668, 'parent_id': 0, 'top_parent_id': 668},
     {'id': 669, 'parent_id': 0, 'top_parent_id': 669},
     {'id': 672, 'parent_id': 0, 'top_parent_id': 672},
     {'id': 687, 'parent_id': 0, 'top_parent_id': 687},
     {'id': 690, 'parent_id': 0, 'top_parent_id': 690},
     {'id': 695, 'parent_id': 0, 'top_parent_id': 695},
     {'id': 700, 'parent_id': 0, 'top_parent_id': 700},
     {'id': 715, 'parent_id': 658, 'top_parent_id': 658},
     {'id': 716, 'parent_id': 487, 'top_parent_id': 487},
     {'id': 717, 'parent_id': 0, 'top_parent_id': 717},
     {'id': 719, 'parent_id': 717, 'top_parent_id': 717},
     {'id': 730, 'parent_id': 487, 'top_parent_id': 487},
     {'id': 731, 'parent_id': 0, 'top_parent_id': 731},
     {'id': 732, 'parent_id': 687, 'top_parent_id': 687},
     {'id': 733, 'parent_id': 732, 'top_parent_id': 687},
     {'id': 737, 'parent_id': 0, 'top_parent_id': 737},
     {'id': 745, 'parent_id': 695, 'top_parent_id': 695},
     {'id': 758, 'parent_id': 0, 'top_parent_id': 758},
     {'id': 759, 'parent_id': 758, 'top_parent_id': 758},
     {'id': 760, 'parent_id': 758, 'top_parent_id': 758},
     {'id': 761, 'parent_id': 760, 'top_parent_id': 758},
     {'id': 762, 'parent_id': 761, 'top_parent_id': 758},
     {'id': 763, 'parent_id': 0, 'top_parent_id': 763},
     {'id': 764, 'parent_id': 624, 'top_parent_id': 120},
     {'id': 765, 'parent_id': 672, 'top_parent_id': 672},
     {'id': 766, 'parent_id': 672, 'top_parent_id': 672},
     {'id': 767, 'parent_id': 0, 'top_parent_id': 767},
     {'id': 770, 'parent_id': 767, 'top_parent_id': 767},
     {'id': 772, 'parent_id': 0, 'top_parent_id': 772},
     {'id': 773, 'parent_id': 772, 'top_parent_id': 772},
     {'id': 774, 'parent_id': 773, 'top_parent_id': 772},
     {'id': 778, 'parent_id': 0, 'top_parent_id': 778},
     {'id': 781, 'parent_id': 731, 'top_parent_id': 731},
     {'id': 782, 'parent_id': 0, 'top_parent_id': 782},
     {'id': 790, 'parent_id': 0, 'top_parent_id': 790},
     {'id': 791, 'parent_id': 790, 'top_parent_id': 790},
     {'id': 792, 'parent_id': 774, 'top_parent_id': 772},
     {'id': 793, 'parent_id': 500, 'top_parent_id': 500},
     {'id': 794, 'parent_id': 0, 'top_parent_id': 794},
     {'id': 796, 'parent_id': 485, 'top_parent_id': 485},
     {'id': 798, 'parent_id': 624, 'top_parent_id': 120},
     {'id': 800, 'parent_id': 0, 'top_parent_id': 800},
     {'id': 801, 'parent_id': 800, 'top_parent_id': 800},
     {'id': 803, 'parent_id': 252, 'top_parent_id': 117},
     {'id': 804, 'parent_id': 0, 'top_parent_id': 804},
     {'id': 806, 'parent_id': 804, 'top_parent_id': 804},
     {'id': 807, 'parent_id': 806, 'top_parent_id': 804},
     {'id': 808, 'parent_id': 804, 'top_parent_id': 804},
     {'id': 809, 'parent_id': 808, 'top_parent_id': 804},
     {'id': 810, 'parent_id': 804, 'top_parent_id': 804},
     {'id': 811, 'parent_id': 0, 'top_parent_id': 811},
     {'id': 812, 'parent_id': 811, 'top_parent_id': 811},
     {'id': 817, 'parent_id': 0, 'top_parent_id': 817},
     {'id': 818, 'parent_id': 817, 'top_parent_id': 817},
     {'id': 819, 'parent_id': 0, 'top_parent_id': 819},
     {'id': 820, 'parent_id': 252, 'top_parent_id': 117},
     {'id': 821, 'parent_id': 819, 'top_parent_id': 819},
     {'id': 823, 'parent_id': 0, 'top_parent_id': 823},
     {'id': 826, 'parent_id': 0, 'top_parent_id': 826},
     {'id': 827, 'parent_id': 826, 'top_parent_id': 826},
     {'id': 830, 'parent_id': 0, 'top_parent_id': 830},
     {'id': 831, 'parent_id': 830, 'top_parent_id': 830},
     {'id': 832, 'parent_id': 0, 'top_parent_id': 832},
     {'id': 833, 'parent_id': 832, 'top_parent_id': 832},
     {'id': 837, 'parent_id': 0, 'top_parent_id': 837},
     {'id': 839, 'parent_id': 837, 'top_parent_id': 837},
     {'id': 842, 'parent_id': 0, 'top_parent_id': 842},
     {'id': 843, 'parent_id': 842, 'top_parent_id': 842},
     {'id': 844, 'parent_id': 843, 'top_parent_id': 842},
     {'id': 852, 'parent_id': 0, 'top_parent_id': 852},
     {'id': 854, 'parent_id': 852, 'top_parent_id': 852},
     {'id': 855, 'parent_id': 0, 'top_parent_id': 855},
     {'id': 856, 'parent_id': 855, 'top_parent_id': 855},
     {'id': 858, 'parent_id': 0, 'top_parent_id': 858},
     {'id': 859, 'parent_id': 858, 'top_parent_id': 858},
     {'id': 860, 'parent_id': 0, 'top_parent_id': 860},
     {'id': 862, 'parent_id': 0, 'top_parent_id': 862},
     {'id': 863, 'parent_id': 862, 'top_parent_id': 862},
     {'id': 864, 'parent_id': 0, 'top_parent_id': 864},
     {'id': 866, 'parent_id': 0, 'top_parent_id': 866},
     {'id': 867, 'parent_id': 866, 'top_parent_id': 866},
     {'id': 872, 'parent_id': 0, 'top_parent_id': 872},
     {'id': 873, 'parent_id': 0, 'top_parent_id': 873},
     {'id': 874, 'parent_id': 0, 'top_parent_id': 874},
     {'id': 878, 'parent_id': 874, 'top_parent_id': 874},
     {'id': 879, 'parent_id': 878, 'top_parent_id': 874},
     {'id': 881, 'parent_id': 874, 'top_parent_id': 874},
     {'id': 882, 'parent_id': 881, 'top_parent_id': 874},
     {'id': 883, 'parent_id': 700, 'top_parent_id': 700},
     {'id': 884, 'parent_id': 0, 'top_parent_id': 884},
     {'id': 885, 'parent_id': 884, 'top_parent_id': 884},
     {'id': 886, 'parent_id': 885, 'top_parent_id': 884},
     {'id': 887, 'parent_id': 0, 'top_parent_id': 887},
     {'id': 889, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 890, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 891, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 892, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 893, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 894, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 895, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 896, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 897, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 898, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 899, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 900, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 901, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 902, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 903, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 904, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 905, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 906, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 907, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 908, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 909, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 910, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 911, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 912, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 913, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 914, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 915, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 916, 'parent_id': 887, 'top_parent_id': 887},
     {'id': 924, 'parent_id': 874, 'top_parent_id': 874},
     {'id': 925, 'parent_id': 874, 'top_parent_id': 874},
     {'id': 926, 'parent_id': 874, 'top_parent_id': 874},
     {'id': 927, 'parent_id': 874, 'top_parent_id': 874},
     {'id': 928, 'parent_id': 874, 'top_parent_id': 874},
     {'id': 929, 'parent_id': 874, 'top_parent_id': 874},
     {'id': 930, 'parent_id': 874, 'top_parent_id': 874},
     {'id': 931, 'parent_id': 874, 'top_parent_id': 874},
     {'id': 932, 'parent_id': 874, 'top_parent_id': 874},
     {'id': 933, 'parent_id': 924, 'top_parent_id': 874},
     {'id': 934, 'parent_id': 924, 'top_parent_id': 874},
     {'id': 935, 'parent_id': 924, 'top_parent_id': 874},
     {'id': 936, 'parent_id': 924, 'top_parent_id': 874},
     {'id': 937, 'parent_id': 925, 'top_parent_id': 874},
     {'id': 938, 'parent_id': 925, 'top_parent_id': 874},
     {'id': 939, 'parent_id': 925, 'top_parent_id': 874},
     {'id': 940, 'parent_id': 926, 'top_parent_id': 874},
     {'id': 941, 'parent_id': 927, 'top_parent_id': 874},
     {'id': 942, 'parent_id': 928, 'top_parent_id': 874},
     {'id': 943, 'parent_id': 928, 'top_parent_id': 874},
     {'id': 944, 'parent_id': 929, 'top_parent_id': 874},
     {'id': 945, 'parent_id': 930, 'top_parent_id': 874},
     {'id': 946, 'parent_id': 930, 'top_parent_id': 874},
     {'id': 947, 'parent_id': 930, 'top_parent_id': 874},
     {'id': 948, 'parent_id': 930, 'top_parent_id': 874},
     {'id': 949, 'parent_id': 930, 'top_parent_id': 874},
     {'id': 950, 'parent_id': 930, 'top_parent_id': 874},
     {'id': 951, 'parent_id': 930, 'top_parent_id': 874},
     {'id': 952, 'parent_id': 930, 'top_parent_id': 874},
     {'id': 953, 'parent_id': 930, 'top_parent_id': 874},
     {'id': 954, 'parent_id': 931, 'top_parent_id': 874},
     {'id': 955, 'parent_id': 932, 'top_parent_id': 874},
     {'id': 956, 'parent_id': 932, 'top_parent_id': 874},
     {'id': 957, 'parent_id': 932, 'top_parent_id': 874},
     {'id': 958, 'parent_id': 932, 'top_parent_id': 874},
     {'id': 959, 'parent_id': 932, 'top_parent_id': 874},
     {'id': 960, 'parent_id': 932, 'top_parent_id': 874},
     {'id': 961, 'parent_id': 932, 'top_parent_id': 874},
     {'id': 962, 'parent_id': 932, 'top_parent_id': 874},
     {'id': 963, 'parent_id': 0, 'top_parent_id': 963},
     {'id': 966, 'parent_id': 963, 'top_parent_id': 963},
     {'id': 967, 'parent_id': 963, 'top_parent_id': 963},
     {'id': 968, 'parent_id': 966, 'top_parent_id': 963},
     {'id': 969, 'parent_id': 967, 'top_parent_id': 963},
     {'id': 970, 'parent_id': 968, 'top_parent_id': 963},
     {'id': 971, 'parent_id': 966, 'top_parent_id': 963},
     {'id': 972, 'parent_id': 971, 'top_parent_id': 963},
     {'id': 973, 'parent_id': 971, 'top_parent_id': 963},
     {'id': 974, 'parent_id': 700, 'top_parent_id': 700},
     {'id': 975, 'parent_id': 700, 'top_parent_id': 700},
     {'id': 976, 'parent_id': 0, 'top_parent_id': 976},
     {'id': 977, 'parent_id': 0, 'top_parent_id': 977},
     {'id': 979, 'parent_id': 977, 'top_parent_id': 977},
     {'id': 980, 'parent_id': 977, 'top_parent_id': 977},
     {'id': 981, 'parent_id': 0, 'top_parent_id': 981},
     {'id': 982, 'parent_id': 790, 'top_parent_id': 790},
     {'id': 983, 'parent_id': 0, 'top_parent_id': 983},
     {'id': 985, 'parent_id': 983, 'top_parent_id': 983},
     {'id': 986, 'parent_id': 485, 'top_parent_id': 485},
     {'id': 987, 'parent_id': 0, 'top_parent_id': 987},
     {'id': 989, 'parent_id': 0, 'top_parent_id': 989},
     {'id': 990, 'parent_id': 0, 'top_parent_id': 990},
     {'id': 991, 'parent_id': 0, 'top_parent_id': 991},
     {'id': 992, 'parent_id': 0, 'top_parent_id': 992},
     {'id': 993, 'parent_id': 967, 'top_parent_id': 963},
     {'id': 994, 'parent_id': 782, 'top_parent_id': 782},
     {'id': 995, 'parent_id': 782, 'top_parent_id': 782},
     {'id': 996, 'parent_id': 994, 'top_parent_id': 782},
     {'id': 997, 'parent_id': 994, 'top_parent_id': 782},
     {'id': 998, 'parent_id': 0, 'top_parent_id': 998},
     {'id': 999, 'parent_id': 963, 'top_parent_id': 963},
     {'id': 1000, 'parent_id': 999, 'top_parent_id': 963},
     {'id': 1001, 'parent_id': 882, 'top_parent_id': 874},
     {'id': 1002, 'parent_id': 983, 'top_parent_id': 983},
     {'id': 1004, 'parent_id': 0, 'top_parent_id': 1004},
     {'id': 1005, 'parent_id': 983, 'top_parent_id': 983},
     {'id': 1006, 'parent_id': 0, 'top_parent_id': 1006},
     {'id': 1007, 'parent_id': 0, 'top_parent_id': 1007},
     {'id': 1008, 'parent_id': 0, 'top_parent_id': 1008},
     {'id': 1010, 'parent_id': 500, 'top_parent_id': 500},
     {'id': 1014, 'parent_id': 0, 'top_parent_id': 1014},
     {'id': 1016, 'parent_id': 0, 'top_parent_id': 1016},
     {'id': 1018, 'parent_id': 1016, 'top_parent_id': 1016},
     {'id': 1024, 'parent_id': 0, 'top_parent_id': 1024},
     {'id': 1025, 'parent_id': 1024, 'top_parent_id': 1024},
     {'id': 1026, 'parent_id': 624, 'top_parent_id': 120},
     {'id': 1028, 'parent_id': 983, 'top_parent_id': 983},
     {'id': 1029, 'parent_id': 1006, 'top_parent_id': 1006},
     {'id': 1030, 'parent_id': 1029, 'top_parent_id': 1006},
     {'id': 1031, 'parent_id': 983, 'top_parent_id': 983},
     {'id': 1033, 'parent_id': 642, 'top_parent_id': 642},
     {'id': 1036, 'parent_id': 0, 'top_parent_id': 1036},
     {'id': 1037, 'parent_id': 1036, 'top_parent_id': 1036},
     {'id': 1038, 'parent_id': 0, 'top_parent_id': 1038},
     {'id': 1042, 'parent_id': 0, 'top_parent_id': 1042},
     {'id': 1043, 'parent_id': 0, 'top_parent_id': 1043},
     {'id': 1044, 'parent_id': 0, 'top_parent_id': 1044},
     {'id': 1046, 'parent_id': 977, 'top_parent_id': 977},
     {'id': 1049, 'parent_id': 0, 'top_parent_id': 1049},
     {'id': 1050, 'parent_id': 1031, 'top_parent_id': 983},
     {'id': 1051, 'parent_id': 0, 'top_parent_id': 1051},
     {'id': 1053, 'parent_id': 930, 'top_parent_id': 874},
     {'id': 1054, 'parent_id': 983, 'top_parent_id': 983},
     {'id': 1055, 'parent_id': 983, 'top_parent_id': 983},
     {'id': 1056, 'parent_id': 874, 'top_parent_id': 874},
     {'id': 1057, 'parent_id': 1056, 'top_parent_id': 874},
     {'id': 1058, 'parent_id': 932, 'top_parent_id': 874},
     {'id': 1065, 'parent_id': 928, 'top_parent_id': 874},
     {'id': 1066, 'parent_id': 874, 'top_parent_id': 874},
     {'id': 1067, 'parent_id': 1066, 'top_parent_id': 874},
     {'id': 1068, 'parent_id': 874, 'top_parent_id': 874},
     {'id': 1069, 'parent_id': 1068, 'top_parent_id': 874},
     {'id': 1070, 'parent_id': 0, 'top_parent_id': 1070},
     {'id': 1073, 'parent_id': 0, 'top_parent_id': 1073},
     {'id': 1074, 'parent_id': 0, 'top_parent_id': 1074},
     {'id': 1075, 'parent_id': 0, 'top_parent_id': 1075},
     {'id': 1077, 'parent_id': 1075, 'top_parent_id': 1075},
     {'id': 1078, 'parent_id': 1074, 'top_parent_id': 1074},
     {'id': 1079, 'parent_id': 0, 'top_parent_id': 1079},
     {'id': 1081, 'parent_id': 1079, 'top_parent_id': 1079},
     {'id': 1082, 'parent_id': 1008, 'top_parent_id': 1008},
     {'id': 1086, 'parent_id': 0, 'top_parent_id': 1086},
     {'id': 1088, 'parent_id': 1086, 'top_parent_id': 1086},
     {'id': 1089, 'parent_id': 0, 'top_parent_id': 1089},
     {'id': 1090, 'parent_id': 0, 'top_parent_id': 1090},
     {'id': 1091, 'parent_id': 0, 'top_parent_id': 1091},
     {'id': 1093, 'parent_id': 502, 'top_parent_id': 500},
     {'id': 1095, 'parent_id': 983, 'top_parent_id': 983},
     {'id': 1099, 'parent_id': 1043, 'top_parent_id': 1043},
     {'id': 1105, 'parent_id': 0, 'top_parent_id': 1105},
     {'id': 1106, 'parent_id': 0, 'top_parent_id': 1106},
     {'id': 1108, 'parent_id': 0, 'top_parent_id': 1108},
     {'id': 1109, 'parent_id': 1105, 'top_parent_id': 1105},
     {'id': 1110, 'parent_id': 1109, 'top_parent_id': 1105},
     {'id': 1112, 'parent_id': 0, 'top_parent_id': 1112},
     {'id': 1113, 'parent_id': 0, 'top_parent_id': 1113},
     {'id': 1114, 'parent_id': 983, 'top_parent_id': 983},
     {'id': 1115, 'parent_id': 0, 'top_parent_id': 1115},
     {'id': 1122, 'parent_id': 1105, 'top_parent_id': 1105},
     {'id': 1124, 'parent_id': 0, 'top_parent_id': 1124},
     {'id': 1127, 'parent_id': 1124, 'top_parent_id': 1124},
     {'id': 1128, 'parent_id': 0, 'top_parent_id': 1128},
     {'id': 1129, 'parent_id': 0, 'top_parent_id': 1129},
     {'id': 1130, 'parent_id': 0, 'top_parent_id': 1130},
     {'id': 1132, 'parent_id': 983, 'top_parent_id': 983},
     {'id': 1133, 'parent_id': 1130, 'top_parent_id': 1130},
     {'id': 1134, 'parent_id': 1133, 'top_parent_id': 1130},
     {'id': 1135, 'parent_id': 0, 'top_parent_id': 1135},
     {'id': 1136, 'parent_id': 1137, 'top_parent_id': 1137},
     {'id': 1137, 'parent_id': 0, 'top_parent_id': 1137},
     {'id': 1138, 'parent_id': 1136, 'top_parent_id': 1137},
     {'id': 1139, 'parent_id': 1137, 'top_parent_id': 1137},
     {'id': 1142, 'parent_id': 983, 'top_parent_id': 983},
     {'id': 1143, 'parent_id': 0, 'top_parent_id': 1143},
     {'id': 1146, 'parent_id': 253, 'top_parent_id': 117},
     {'id': 1147, 'parent_id': 1146, 'top_parent_id': 117},
     {'id': 1148, 'parent_id': 1147, 'top_parent_id': 117},
     {'id': 1151, 'parent_id': 0, 'top_parent_id': 1151},
     {'id': 1156, 'parent_id': 976, 'top_parent_id': 976},
     {'id': 1157, 'parent_id': 976, 'top_parent_id': 976},
     {'id': 1158, 'parent_id': 1157, 'top_parent_id': 976},
     {'id': 1162, 'parent_id': 1091, 'top_parent_id': 1091},
     {'id': 2503, 'parent_id': 0, 'top_parent_id': 2503},
     {'id': 2504, 'parent_id': 0, 'top_parent_id': 2504},
     {'id': 2505, 'parent_id': 2504, 'top_parent_id': 2504},
     {'id': 2506, 'parent_id': 0, 'top_parent_id': 2506},
     {'id': 2507, 'parent_id': 2504, 'top_parent_id': 2504},
     {'id': 2508, 'parent_id': 2504, 'top_parent_id': 2504},
     {'id': 2509, 'parent_id': 2504, 'top_parent_id': 2504},
     {'id': 2510, 'parent_id': 0, 'top_parent_id': 2510},
     {'id': 2511, 'parent_id': 2504, 'top_parent_id': 2504},
     {'id': 2513, 'parent_id': 2504, 'top_parent_id': 2504},
     {'id': 2514, 'parent_id': 2504, 'top_parent_id': 2504},
     {'id': 2515, 'parent_id': 2504, 'top_parent_id': 2504},
     {'id': 2516, 'parent_id': 2506, 'top_parent_id': 2506},
     {'id': 2519, 'parent_id': 983, 'top_parent_id': 983},
     {'id': 2520, 'parent_id': 2504, 'top_parent_id': 2504},
     {'id': 2521, 'parent_id': 2504, 'top_parent_id': 2504},
     {'id': 2523, 'parent_id': 2504, 'top_parent_id': 2504},
     {'id': 2524, 'parent_id': 0, 'top_parent_id': 2524},
     {'id': 2525, 'parent_id': 1130, 'top_parent_id': 1130},
     {'id': 2526, 'parent_id': 489, 'top_parent_id': 489},
     {'id': 2527, 'parent_id': 0, 'top_parent_id': 2527},
     {'id': 2528, 'parent_id': 1130, 'top_parent_id': 1130},
     {'id': 2529, 'parent_id': 1130, 'top_parent_id': 1130},
     {'id': 2530, 'parent_id': 2504, 'top_parent_id': 2504},
     {'id': 2531, 'parent_id': 0, 'top_parent_id': 2531},
     {'id': 2532, 'parent_id': 2504, 'top_parent_id': 2504},
     {'id': 2533, 'parent_id': 2504, 'top_parent_id': 2504},
     {'id': 2534, 'parent_id': 0, 'top_parent_id': 2534},
     {'id': 2535, 'parent_id': 0, 'top_parent_id': 2535},
     {'id': 2536, 'parent_id': 2504, 'top_parent_id': 2504},
     {'id': 2537, 'parent_id': 1105, 'top_parent_id': 1105},
     {'id': 2538, 'parent_id': 0, 'top_parent_id': 2538},
     {'id': 2539, 'parent_id': 2538, 'top_parent_id': 2538},
     {'id': 2540, 'parent_id': 2538, 'top_parent_id': 2538},
     {'id': 2541, 'parent_id': 0, 'top_parent_id': 2541},
     {'id': 2542, 'parent_id': 2541, 'top_parent_id': 2541},
     {'id': 2543, 'parent_id': 0, 'top_parent_id': 2543},
     {'id': 2544, 'parent_id': 0, 'top_parent_id': 2544},
     {'id': 2545, 'parent_id': 0, 'top_parent_id': 2545},
     {'id': 2546, 'parent_id': 500, 'top_parent_id': 500},
     {'id': 2547, 'parent_id': 500, 'top_parent_id': 500},
     {'id': 2548, 'parent_id': 500, 'top_parent_id': 500},
     {'id': 2549, 'parent_id': 1130, 'top_parent_id': 1130},
     {'id': 2550, 'parent_id': 0, 'top_parent_id': 2550},
     {'id': 2551, 'parent_id': 0, 'top_parent_id': 2551},
     {'id': 2552, 'parent_id': 2504, 'top_parent_id': 2504},
     {'id': 2553, 'parent_id': 0, 'top_parent_id': 2553},
     {'id': 2554, 'parent_id': 0, 'top_parent_id': 2554},
     {'id': 2555, 'parent_id': 0, 'top_parent_id': 2555},
     {'id': 2556, 'parent_id': 0, 'top_parent_id': 2556},
     {'id': 2557, 'parent_id': 1008, 'top_parent_id': 1008},
     {'id': 2561, 'parent_id': 500, 'top_parent_id': 500},
     {'id': 2562, 'parent_id': 500, 'top_parent_id': 500},
     {'id': 2563, 'parent_id': 0, 'top_parent_id': 2563},
     {'id': 2564, 'parent_id': 0, 'top_parent_id': 2564},
     {'id': 2565, 'parent_id': 0, 'top_parent_id': 2565},
     {'id': 2567, 'parent_id': 0, 'top_parent_id': 2567},
     {'id': 2568, 'parent_id': 0, 'top_parent_id': 2568}]

from collections import OrderedDict
import json


class Depth(object):
    def __init__(self, depth):
        self.__depth = depth

    @property
    def depth(self):
        if getattr(self, 'other', None):
            return self.__depth + self.other.depth
        return self.__depth

    def __iadd__(self, other):
        self.other = other
        return self

    def __repr__(self):
        return f"Depth({self.depth})"


def json_default(obj):
    if isinstance(obj, Depth):
        return obj.depth


def make_tree(result):
    """将结果集构成树状结构"""
    trees = OrderedDict()
    subs = {}
    for row in result:
        trees[row['id']] = row
        trees[row['id']]['depth'] = Depth(1)
    for row in result:
        if row['parent_id'] in trees:
            subs[row['id']] = trees.pop(row['id'])
            trees[row['parent_id']].setdefault(
                'children', []
            ).append(subs[row['id']])
            subs[row['id']]['depth'] += trees[row['parent_id']]['depth']
        elif row['parent_id'] in subs:
            subs[row['id']] = trees.pop(row['id'])
            subs[row['parent_id']].setdefault(
                'children', []
            ).append(subs[row['id']])
            subs[row['id']]['depth'] += subs[row['parent_id']]['depth']

    return list(trees.values())


if __name__ == '__main__':
    # trees2 = make_tree(a)
    # print(trees2)
    # print(json.dumps(trees2,default=json_default))
    random.shuffle(a)
    tree3 = make_tree(a)

    print(json.dumps(tree3, default=json_default))
